<!DOCTYPE html>
<html lang="en">
<!-- Previous head and style sections remain the same -->

<script>
    // Convert string to Uint8Array for crypto operations
    function str2ab(str) {
        const buf = new Uint8Array(str.length);
        for (let i = 0; i < str.length; i++) {
            buf[i] = str.charCodeAt(i);
        }
        return buf;
    }

    // Base64Url encode
    function base64UrlEncode(str) {
        return btoa(str)
            .replace(/\+/g, '-')
            .replace(/\//g, '_')
            .replace(/=/g, '');
    }

    // Convert ArrayBuffer to Base64Url string
    function arrayBufferToBase64Url(arrayBuffer) {
        const bytes = new Uint8Array(arrayBuffer);
        let binary = '';
        for (let i = 0; i < bytes.byteLength; i++) {
            binary += String.fromCharCode(bytes[i]);
        }
        return base64UrlEncode(binary);
    }

    async function generateSignedJWT() {
        // Create header
        const header = {
            alg: 'HS256',
            typ: 'JWT'
        };

        // Set specific date and time
        const specificDate = new Date('2025-01-12T21:48:11Z');
        const iat = Math.floor(specificDate.getTime() / 1000);
        const exp = iat + (2 * 365 * 24 * 60 * 60); // 2 years from iat

        // Create payload
        const payload = {
            role: 'anon',
            iss: 'fortunestoldco',
            iat: iat,
            exp: exp
        };

        // Encode header and payload
        const encodedHeader = base64UrlEncode(JSON.stringify(header));
        const encodedPayload = base64UrlEncode(JSON.stringify(payload));
        const signingInput = `${encodedHeader}.${encodedPayload}`;

        // Generate a consistent key for signing
        const keyMaterial = await crypto.subtle.importKey(
            'raw',
            str2ab('your-256-bit-secret'),
            { name: 'HMAC', hash: 'SHA-256' },
            false,
            ['sign']
        );

        // Sign the JWT
        const signature = await crypto.subtle.sign(
            'HMAC',
            keyMaterial,
            str2ab(signingInput)
        );

        // Combine all parts
        return `${signingInput}.${arrayBufferToBase64Url(signature)}`;
    }

    function generateRandomString() {
        const array = new Uint8Array(32);
        crypto.getRandomValues(array);
        return btoa(String.fromCharCode.apply(null, array))
            .replace(/[/+=]/g, '')
            .slice(0, 32);
    }

    document.getElementById('generateJWT').addEventListener('click', async () => {
        const result = await generateSignedJWT();
        const resultInput = document.getElementById('result');
        resultInput.value = result;
        resultInput.setAttribute('title', 'JWT Token');
    });

    document.getElementById('generateRandom').addEventListener('click', () => {
        const result = generateRandomString();
        const resultInput = document.getElementById('result');
        resultInput.value = result;
        resultInput.setAttribute('title', 'Random String');
    });

    // Copy button handler remains the same
</script>
</html>
